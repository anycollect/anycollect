extensions:
- !load
  extension: SelfDiscovery
  instance: self
  injectMode: auto
  scope: global
  priority: default
- !load
  extension: MeterRegistry
  instance: registry
  injectMode: auto
  scope: global
  priority: default
  config:
    globalPrefix: "anycollect"
    commonMeta:
      source: internal
- !load
  extension: PullEngine
  instance: puller
  injectMode: auto
  scope: global
  priority: default
  config:
    updatePeriod: 10
    pullPeriod: 10
    defaultPoolSize: 1
    rules: []
    healthChecks:
      period: 20
      timeout: 5
      checks: []
- !load
  extension: MeterRegistryReader
  instance: selfReader
  injectMode: manual
  scope: global
  priority: default

# Graphite
- !load
  extension: TagGraphiteSerializer
  instance: toTagGraphite
  injectMode: manual
  scope: global
  priority: default

# System
- !load
  extension: SystemReader
  instance: system
  injectMode: manual
  scope: global
  priority: default

# Slf4j
- !load
  extension: Slf4jWriter
  instance: slf4j
  injectMode: manual
  scope: global
  priority: default

# JMX monitoring of current app
- !load
  extension: CurrentApp
  instance: jvm
  injectMode: manual
  scope: global
  priority: default
  config:
    name: anycollect
- !load
  extension: Measurers
  instance: measurers
  scope: local
  injectMode: auto
  config:
    families:
    - name: uptime
      measurements:
      - { id: value, path: Uptime, type: timestamp, stat: value }
# Queries
- !load
  extension: StaticJmxQueryProvider
  instance: jvmMetrics
  injectMode: manual
  scope: global
  priority: default
  config:
    queries:
    - "@class": .JvmMemory
    - "@class": .JvmThreads
    - queryId: jvm.runtime.uptime
      mbean: "java.lang:type=Runtime"
      families:
      - what: jvm.runtime.uptime
        name: uptime
        baseUnit: ms